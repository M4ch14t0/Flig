<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Login</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #0A2A5D;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0d3a80;
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }
        .log {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>üß™ Teste de Login - FLIG MVP</h1>
    
    <div class="test-section">
        <h2>1. Teste de localStorage</h2>
        <button onclick="testLocalStorage()">Testar localStorage</button>
        <button onclick="clearLocalStorage()">Limpar localStorage</button>
        <div id="localStorage-log" class="log"></div>
    </div>

    <div class="test-section">
        <h2>2. Teste de Login Simulado</h2>
        <input type="email" id="testEmail" placeholder="Email" value="teste@exemplo.com">
        <input type="password" id="testPassword" placeholder="Senha" value="123456">
        <button onclick="simulateLogin()">Simular Login</button>
        <div id="login-log" class="log"></div>
    </div>

    <div class="test-section">
        <h2>3. Teste de Navega√ß√£o</h2>
        <button onclick="testNavigation()">Testar Navega√ß√£o para /cliente/home</button>
        <div id="navigation-log" class="log"></div>
    </div>

    <div class="test-section">
        <h2>4. Status Atual</h2>
        <button onclick="checkStatus()">Verificar Status</button>
        <div id="status-log" class="log"></div>
    </div>

    <script>
        function log(elementId, message) {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            element.textContent += `[${timestamp}] ${message}\n`;
            element.scrollTop = element.scrollHeight;
        }

        function testLocalStorage() {
            const logElement = 'localStorage-log';
            log(logElement, '=== Teste de localStorage ===');
            
            try {
                // Teste de escrita
                localStorage.setItem('test-key', 'test-value');
                log(logElement, '‚úÖ Escrita no localStorage: OK');
                
                // Teste de leitura
                const value = localStorage.getItem('test-key');
                log(logElement, `‚úÖ Leitura do localStorage: ${value}`);
                
                // Teste de remo√ß√£o
                localStorage.removeItem('test-key');
                log(logElement, '‚úÖ Remo√ß√£o do localStorage: OK');
                
                // Verificar dados de auth existentes
                const authToken = localStorage.getItem('authToken');
                const userType = localStorage.getItem('userType');
                const userEmail = localStorage.getItem('userEmail');
                
                log(logElement, `üìã Dados de auth existentes:`);
                log(logElement, `   - authToken: ${authToken ? 'Presente' : 'Ausente'}`);
                log(logElement, `   - userType: ${userType || 'Ausente'}`);
                log(logElement, `   - userEmail: ${userEmail || 'Ausente'}`);
                
            } catch (error) {
                log(logElement, `‚ùå Erro no localStorage: ${error.message}`);
            }
        }

        function clearLocalStorage() {
            const logElement = 'localStorage-log';
            try {
                localStorage.clear();
                log(logElement, 'üóëÔ∏è localStorage limpo com sucesso');
            } catch (error) {
                log(logElement, `‚ùå Erro ao limpar localStorage: ${error.message}`);
            }
        }

        function simulateLogin() {
            const logElement = 'login-log';
            const email = document.getElementById('testEmail').value;
            const password = document.getElementById('testPassword').value;
            
            log(logElement, '=== Simula√ß√£o de Login ===');
            log(logElement, `üìß Email: ${email}`);
            log(logElement, `üîë Senha: ${password}`);
            
            try {
                // Simular o processo de login do AuthContext
                const mockToken = `mock-jwt-token-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;
                const mockUser = {
                    id: Date.now(),
                    email: email,
                    name: email.split('@')[0],
                    type: 'cliente',
                    token: mockToken,
                };
                
                // Salvar no localStorage
                localStorage.setItem('authToken', mockToken);
                localStorage.setItem('userType', 'cliente');
                localStorage.setItem('userEmail', mockUser.email);
                localStorage.setItem('userName', mockUser.name);
                
                log(logElement, '‚úÖ Login simulado com sucesso');
                log(logElement, `   - Token: ${mockToken.substring(0, 20)}...`);
                log(logElement, `   - User: ${mockUser.name}`);
                log(logElement, `   - Type: ${mockUser.type}`);
                
            } catch (error) {
                log(logElement, `‚ùå Erro na simula√ß√£o: ${error.message}`);
            }
        }

        function testNavigation() {
            const logElement = 'navigation-log';
            log(logElement, '=== Teste de Navega√ß√£o ===');
            
            try {
                // Verificar se estamos na aplica√ß√£o React
                if (window.location.hostname === 'localhost' && window.location.port === '5173') {
                    log(logElement, '‚úÖ Estamos na aplica√ß√£o React (localhost:5173)');
                    
                    // Tentar navegar para a rota
                    const targetUrl = '/cliente/home';
                    log(logElement, `üîÑ Tentando navegar para: ${targetUrl}`);
                    
                    // Simular navega√ß√£o
                    window.location.href = targetUrl;
                    
                } else {
                    log(logElement, '‚ö†Ô∏è N√£o estamos na aplica√ß√£o React');
                    log(logElement, `   URL atual: ${window.location.href}`);
                    log(logElement, '   Abra a aplica√ß√£o em http://localhost:5173');
                }
                
            } catch (error) {
                log(logElement, `‚ùå Erro na navega√ß√£o: ${error.message}`);
            }
        }

        function checkStatus() {
            const logElement = 'status-log';
            log(logElement, '=== Status Atual ===');
            
            // Verificar localStorage
            const authToken = localStorage.getItem('authToken');
            const userType = localStorage.getItem('userType');
            const userEmail = localStorage.getItem('userEmail');
            
            log(logElement, `üîê Autentica√ß√£o:`);
            log(logElement, `   - Token: ${authToken ? '‚úÖ Presente' : '‚ùå Ausente'}`);
            log(logElement, `   - Tipo: ${userType || '‚ùå Ausente'}`);
            log(logElement, `   - Email: ${userEmail || '‚ùå Ausente'}`);
            
            // Verificar URL
            log(logElement, `üåê URL atual: ${window.location.href}`);
            
            // Verificar se √© localhost:5173
            if (window.location.hostname === 'localhost' && window.location.port === '5173') {
                log(logElement, '‚úÖ Aplica√ß√£o React detectada');
            } else {
                log(logElement, '‚ö†Ô∏è N√£o estamos na aplica√ß√£o React');
            }
        }

        // Executar verifica√ß√£o inicial
        window.onload = function() {
            checkStatus();
        };
    </script>
</body>
</html>

